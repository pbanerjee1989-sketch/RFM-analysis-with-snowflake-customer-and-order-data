# Customer Segmentation Analysis with RFM

## Business Scenario

You are a data analyst at a global retail company. Leadership and the marketing team want a deep dive into customer value and ordering behavior to guide the rollout of new marketing campaigns to boost growth.

They are particularly interested in:

- Identifying high-value customers  
- Understanding customer ordering patterns  
- Segmenting customers to tailor marketing campaigns  

To do this, you will use **RFM analysis**, a widely-used method to evaluate customers based on:

- **Recency**: How recently a customer placed an order  
- **Frequency**: How often a customer places orders  
- **Monetary**: How much a customer has spent  

RFM segmentation helps businesses target loyal, high-spending customers, identify at-risk customers, and prioritize engagement strategies.

---

## Part 1. Customer Segmentation (RFM)

### Objective
Segment customers based on **Recency, Frequency, and Monetary value**.

### Dataset
`snowflake_sample_data.tpch_sf1`

> **Note:** The TPCH sample data represents transactions from the 1990s. Treat the data as if it were current. When calculating recency, use the most recent order date in the dataset as the reference point.

### Requirements

Your final query should produce **one row per customer** and include:

- Unique customer identifier  
- Relevant customer details  
- Nation name  
- Last order date  
- Total revenue  
- Total number of orders  
- Average order value  
- RFM values (Recency, Frequency, Monetary)  
- RFM score  
- RFM segment  

Sort the output in a logical way (e.g., highest value customers first).

### Deliverables

- **One SQL query** that ends with:
  ```sql
  SELECT * FROM final;

  ## Part 2. Segment Exploration

Based on the work you did for Part 1, now that you have built your customer segmentation, it’s time to use it to ask questions and extract some insights. In this part, you will practice analyzing your segmentation results with SQL.

### Tasks

1. Find out how many customers fall into each segment.  
2. Calculate the total revenue generated by each segment.  
3. Identify the top 5 High Value customers by the RFM score.  
4. Show which nations have the highest number of High Value customers.

### Deliverable

- One SQL query for each task above. Each query should replace the `SELECT * FROM final` statement from Part 1, so you only need to provide that final query section for each task.
- Short written answers to the above questions. Think one or two sentences per question (if you have many segments, around one sentence per segment is acceptable).

## Part 3. Written Insights

Now that you have explored your customer segments with SQL, it’s time to interpret the results and think like an analyst.

In this part, you will write short reflections and recommendations based on your findings. When answering, think about which insights are most important for leadership to see, and try to structure your answers clearly (e.g., grouping observations, key metrics, and recommendations).

### Please Answer the Following

#### 1. RFM Scoring and Segmentation Approach
- Can you explain the RFM scoring and segmentation method you used, including the reasoning behind your chosen approach?

#### 2. Key RFM Driver
- Based on your analysis, which of Recency, Frequency, or Monetary Value appears to be the most significant in explaining customer behavior and why?

#### 3. Segment Distribution Insights
- What does the distribution of customers across the different RFM segments reveal about the company’s overall customer base?

#### 4. Strategic Recommendations
- What insights and recommendations would you provide to the leadership and marketing teams based on your findings?

#### 5. Further Analysis
- What additional analyses could be performed to gain a deeper understanding of customer segments and behaviors and why?

### Deliverable

- Written answers to the above questions.
- Approximately **5–6 sentences per question**.
